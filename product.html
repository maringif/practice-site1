<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Product</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.3/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
  <div id="header-placeholder"></div>
  <script>
    fetch("header.html")
      .then(response => response.text())
      .then(data => {
        document.getElementById("header-placeholder").innerHTML = data;
        if(window.Alpine && window.Alpine.initTree){
          Alpine.initTree(document.getElementById("header-placeholder"));
        }
      });
  </script>
  <div class="max-w-6xl mx-auto py-8">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4">
      <h1 class="text-2xl font-bold">
        Products
        <span id="category-name" class="ml-4 text-lg text-blue-600"></span>
      </h1>
      <span id="product-count" class="text-gray-500 text-sm"></span>
      <span id="product-range" class="text-gray-500 text-sm ml-4"></span>
    </div>
    <div id="product-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6"></div>
    <div id="pagination" class="mt-8 flex justify-center gap-2"></div>
  </div>

  <script type="module">
    // main.jsのsearchProductsと同じ商品データ（ここにも定義するか、importで共有してください）
    // ここでは直接定義します
    const searchProducts = [
      ...Array.from({length: 100}, (_, i) => ({ name: `Tomato ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Cucumber ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Lettuce ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Carrot ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Potato ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Onion ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Spinach ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Broccoli ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Pepper ${i+1}`, category: "Fruits & Veges" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Eggplant ${i+1}`, category: "Fruits & Veges" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `White Bread ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Croissant ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Baguette ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Donut ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Muffin ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Danish ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Brioche ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Roll Cake ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Pound Cake ${i+1}`, category: "Breads & Sweets" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Scone ${i+1}`, category: "Breads & Sweets" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Red Wine ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `White Wine ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Rose Wine ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Sparkling Wine ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Port Wine ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Sherry ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Vermouth ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Sangria ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Mead ${i+1}`, category: "Wine Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Mulled Wine ${i+1}`, category: "Wine Drinks" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Olive Oil ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Sunflower Oil ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Coconut Oil ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Sesame Oil ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Avocado Oil ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Grapeseed Oil ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Peanut Oil ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Canola Oil ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Butter Ghee ${i+1}`, category: "Oil & Ghee" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Clarified Butter ${i+1}`, category: "Oil & Ghee" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Beef Steak ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Chicken Breast ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Pork Chop ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Lamb Leg ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Duck Breast ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Turkey Thigh ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Veal Cutlet ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Goose Liver ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Rabbit Meat ${i+1}`, category: "Raw Meat" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Venison ${i+1}`, category: "Raw Meat" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Basil ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Mint ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Rosemary ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Thyme ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Oregano ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Sage ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Dill ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Coriander ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Parsley ${i+1}`, category: "Natural Herbs" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Tarragon ${i+1}`, category: "Natural Herbs" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Salmon ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Tuna ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Shrimp ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Crab ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Lobster ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Scallop ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Oyster ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Mussel ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Cod ${i+1}`, category: "Seafood" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Squid ${i+1}`, category: "Seafood" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Orange Juice ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Apple Juice ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Grape Juice ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Lemonade ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Iced Tea ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Cola ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Ginger Ale ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Mineral Water ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Tomato Juice ${i+1}`, category: "Non-Alcoholic Drinks" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Vegetable Juice ${i+1}`, category: "Non-Alcoholic Drinks" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Salt ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Pepper ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Soy Sauce ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Vinegar ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Mustard ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Ketchup ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Mayonnaise ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Chili Powder ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Curry Powder ${i+1}`, category: "Seasonings" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Garlic Powder ${i+1}`, category: "Seasonings" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Potato Chips ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Popcorn ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Pretzel ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Chocolate Bar ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Gummy Candy ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Marshmallow ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Cookie ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Biscuit ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Rice Cracker ${i+1}`, category: "Snacks & Confectionery" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Fruit Snack ${i+1}`, category: "Snacks & Confectionery" })),

      ...Array.from({length: 100}, (_, i) => ({ name: `Milk ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Yogurt ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Butter ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Cheese ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Cream ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Sour Cream ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Cottage Cheese ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Ice Cream ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Evaporated Milk ${i+1}`, category: "Dairy Products" })),
      ...Array.from({length: 100}, (_, i) => ({ name: `Condensed Milk ${i+1}`, category: "Dairy Products" })),
    ];

    // クエリ取得
    function getQueryParam(name) {
      return new URLSearchParams(window.location.search).get(name);
    }
    const search = getQueryParam('search');
    const category = getQueryParam('category');
    const page = parseInt(getQueryParam('page') || '1', 10);

    // フィルタ処理
    let filtered = searchProducts;
    if (search) {
      filtered = filtered.filter(p => p.name.toLowerCase().includes(search.toLowerCase()));
    }
    if (category) {
      filtered = filtered.filter(p => p.category === category);
    }
    // カテゴリ名表示
    document.getElementById('category-name').textContent = category ? category : '';

    // ページング
    const itemsPerPage = 20;
    const total = filtered.length;
    const pageCount = Math.max(1, Math.ceil(total / itemsPerPage));
    document.getElementById('product-count').textContent = `(${total} items)`;

    // 商品表示
    const grid = document.getElementById('product-grid');
    grid.innerHTML = '';
    const startIdx = (page - 1) * itemsPerPage;
    const endIdx = Math.min(page * itemsPerPage, total);

    filtered.slice(startIdx, endIdx).forEach(product => {
      grid.innerHTML += `
        <div class="bg-white rounded shadow p-4">
          <img src="https://placehold.co/200x200?text=${encodeURIComponent(product.name)}" alt="${product.name}" class="mb-2">
          <div class="font-bold">${product.name}</div>
          <div class="text-sm text-gray-500">Category: ${product.category}</div>
        </div>
      `;
    });

    // 1/100 のような形式で表示
    const productRange = document.getElementById('product-range');
    if (total === 0) {
      productRange.textContent = '0/0';
    } else {
      productRange.textContent = `${startIdx + 1}〜${endIdx} / ${total}`;
    }

    // ページネーション
    const pag = document.getElementById('pagination');
    pag.innerHTML = '';
    if (pageCount > 1) {
      if (page > 1) {
        pag.innerHTML += `<a href="?search=${encodeURIComponent(search||'')}&category=${encodeURIComponent(category||'')}&page=${page-1}" class="px-3 py-1 bg-gray-200 rounded">&lt;</a>`;
      }
      for(let i = Math.max(1, page-2); i <= Math.min(pageCount, page+2); i++){
        pag.innerHTML += `<a href="?search=${encodeURIComponent(search||'')}&category=${encodeURIComponent(category||'')}&page=${i}" class="px-3 py-1 rounded ${i===page?'bg-blue-500 text-white':'bg-gray-200'}">${i}</a>`;
      }
      if (page < pageCount) {
        pag.innerHTML += `<a href="?search=${encodeURIComponent(search||'')}&category=${encodeURIComponent(category||'')}&page=${page+1}" class="px-3 py-1 bg-gray-200 rounded">&gt;</a>`;
      }
    }
  </script>
  <script type="module" src="./src/js/main.js"></script>
</body>
</html>